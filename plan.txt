НУЖНО ИСПРАВИТЬ ЧЕК РОУ
он работает жутко криво и протоколы составляет по неправильной схеме!
тем более, что он получает на вход только обрезанную часть, а значит не может выдать общего индекса ряда, так как он хз вообще о ряде!
тем не менее: стоит сделать чек роу собирающим протокол, который друдно сосотавляюбт пара других функций, если это, конечно, потребуется.
1) понять, как правильно составить протокол
2) решить проблему с различающейся индексацией чек массива и ряда
3) встроить это в код и проверить работоспособность.